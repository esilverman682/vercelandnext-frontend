{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useContext, useState, useEffect } from \"react\";\nimport Link from 'next/link';\nimport Head from 'next/head';\nimport AuthContext from \"../context/AuthContext\";\nimport { API_URL } from '../utils/urls';\n\nvar useOrders = function useOrders(user, getToken) {\n  var _useState = useState([]),\n      orders = _useState[0],\n      setOrders = _useState[1];\n\n  var _useState2 = useState(false),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  useEffect(function () {\n    var fetchOrders = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var token, orderRes, data;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                setLoading(true);\n\n                if (!user) {\n                  _context.next = 18;\n                  break;\n                }\n\n                _context.prev = 2;\n                _context.next = 5;\n                return getToken();\n\n              case 5:\n                token = _context.sent;\n                _context.next = 8;\n                return fetch(\"\".concat(API_URL, \"/orders\"), {\n                  headers: {\n                    'Authorization': \"Bearer \".concat(token)\n                  }\n                });\n\n              case 8:\n                orderRes = _context.sent;\n                _context.next = 11;\n                return orderRes.json();\n\n              case 11:\n                data = _context.sent;\n                setOrders(data);\n                _context.next = 18;\n                break;\n\n              case 15:\n                _context.prev = 15;\n                _context.t0 = _context[\"catch\"](2);\n                setOrders([]);\n\n              case 18:\n                setLoading(false);\n\n              case 19:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[2, 15]]);\n      }));\n\n      return function fetchOrders() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    fetchOrders();\n  }, [user]);\n  return {\n    orders: orders,\n    loading: loading\n  };\n};\n\nexport default (function () {\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user,\n      logoutUser = _useContext.logoutUser,\n      getToken = _useContext.getToken;\n\n  var _useOrders = useOrders(user, getToken),\n      orders = _useOrders.orders,\n      loading = _useOrders.loading;\n\n  if (!user) {\n    return /*#__PURE__*/_jsxs(\"div\", {\n      children: [/*#__PURE__*/_jsx(\"p\", {\n        children: \"Please Login or Register before accessing this page\"\n      }), /*#__PURE__*/_jsx(Link, {\n        href: \"/\",\n        children: /*#__PURE__*/_jsx(\"a\", {\n          children: \"Go Back\"\n        })\n      })]\n    });\n  }\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [/*#__PURE__*/_jsx(\"title\", {\n        children: \"Your Account\"\n      }), /*#__PURE__*/_jsx(\"meta\", {\n        name: \"description\",\n        content: \"Your orders will be shown here\"\n      })]\n    }), /*#__PURE__*/_jsx(\"h2\", {\n      children: \"Account Page\"\n    }), /*#__PURE__*/_jsx(\"h3\", {\n      children: \"Your Orders\"\n    }), loading && /*#__PURE__*/_jsx(\"p\", {\n      children: \"Orders are Loading\"\n    }), orders.map(function (order) {\n      return /*#__PURE__*/_jsxs(\"div\", {\n        children: [new Date(order.created_at).toLocaleDateString('en-EN'), \" \", order.product.name, \" $\", order.total, \" \", order.status]\n      }, order.id);\n    }), /*#__PURE__*/_jsx(\"hr\", {}), /*#__PURE__*/_jsxs(\"p\", {\n      children: [\"Logged in as \", user.email]\n    }), /*#__PURE__*/_jsx(\"p\", {\n      children: /*#__PURE__*/_jsx(\"a\", {\n        href: \"#\",\n        onClick: logoutUser,\n        children: \"Logout\"\n      })\n    })]\n  });\n});","map":null,"metadata":{},"sourceType":"module"}