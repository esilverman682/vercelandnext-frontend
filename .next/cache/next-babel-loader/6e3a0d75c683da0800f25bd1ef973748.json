{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState, useEffect, useContext } from 'react';\nimport AuthContext from '../context/AuthContext';\nimport { useRouter } from 'next/router';\nimport { API_URL } from '../utils/urls';\nimport Link from 'next/link';\n\nconst useOrder = session_id => {\n  const {\n    0: order,\n    1: setOrder\n  } = useState(null);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(null);\n  const {\n    getToken,\n    user\n  } = useContext(AuthContext);\n  useEffect(() => {\n    if (user) {\n      const fetchOrder = async () => {\n        setLoading(true);\n\n        try {\n          const token = await getToken();\n          const res = await fetch(`${API_URL}/orders/confirm`, {\n            method: 'POST',\n            body: JSON.stringify({\n              checkout_session: session_id\n            }),\n            headers: {\n              'Content-type': 'application/json',\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          const data = await res.json();\n          setOrder(data);\n        } catch (err) {\n          setOrder(null);\n        }\n\n        setLoading(false);\n      };\n\n      fetchOrder();\n    }\n  }, [user]);\n  return {\n    order,\n    loading\n  };\n};\n\nexport default function Success() {\n  const router = useRouter();\n  const {\n    session_id\n  } = router.query;\n  const {\n    order,\n    loading\n  } = useOrder(session_id);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsx(\"h2\", {\n      children: \"Hold on!\"\n    }), loading && /*#__PURE__*/_jsx(\"p\", {\n      children: \"We're confirming your purchase!\"\n    }), !loading && order && /*#__PURE__*/_jsxs(\"p\", {\n      children: [\"Your order was processed successfully! \", /*#__PURE__*/_jsx(Link, {\n        href: \"/account\",\n        children: \"View Orders\"\n      })]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}