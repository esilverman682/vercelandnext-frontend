{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useState, useEffect, useContext } from 'react';\nimport AuthContext from '../context/AuthContext';\nimport { useRouter } from 'next/router';\nimport { API_URL } from '../utils/urls';\nimport Link from 'next/link';\n\nvar useOrder = function useOrder(session_id) {\n  var _useState = useState(null),\n      order = _useState[0],\n      setOrder = _useState[1];\n\n  var _useState2 = useState(null),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useContext = useContext(AuthContext),\n      getToken = _useContext.getToken,\n      user = _useContext.user;\n\n  useEffect(function () {\n    if (user) {\n      var fetchOrder = /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          var token, res, data;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  setLoading(true);\n                  _context.prev = 1;\n                  _context.next = 4;\n                  return getToken();\n\n                case 4:\n                  token = _context.sent;\n                  _context.next = 7;\n                  return fetch(\"\".concat(API_URL, \"/orders/confirm\"), {\n                    method: 'POST',\n                    body: JSON.stringify({\n                      checkout_session: session_id\n                    }),\n                    headers: {\n                      'Content-type': 'application/json',\n                      'Authorization': \"Bearer \".concat(token)\n                    }\n                  });\n\n                case 7:\n                  res = _context.sent;\n                  _context.next = 10;\n                  return res.json();\n\n                case 10:\n                  data = _context.sent;\n                  setOrder(data);\n                  _context.next = 17;\n                  break;\n\n                case 14:\n                  _context.prev = 14;\n                  _context.t0 = _context[\"catch\"](1);\n                  setOrder(null);\n\n                case 17:\n                  setLoading(false);\n\n                case 18:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, null, [[1, 14]]);\n        }));\n\n        return function fetchOrder() {\n          return _ref.apply(this, arguments);\n        };\n      }();\n\n      fetchOrder();\n    }\n  }, [user]);\n  return {\n    order: order,\n    loading: loading\n  };\n};\n\nexport default function Success() {\n  var router = useRouter();\n  var session_id = router.query.session_id;\n\n  var _useOrder = useOrder(session_id),\n      order = _useOrder.order,\n      loading = _useOrder.loading;\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsx(\"h2\", {\n      children: \"Hold on!\"\n    }), loading && /*#__PURE__*/_jsx(\"p\", {\n      children: \"We're confirming your purchase!\"\n    }), !loading && order && /*#__PURE__*/_jsxs(\"p\", {\n      children: [\"Your order was processed successfully! \", /*#__PURE__*/_jsx(Link, {\n        href: \"/account\",\n        children: \"View Orders\"\n      })]\n    })]\n  });\n}","map":null,"metadata":{},"sourceType":"module"}